<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
		<script src="index.js"></script>
		<script>
			var snapshots = [];
			// Initialize Firebase
			var config = {
				apiKey: "AIzaSyAXiF9S5Ph7N1mb8FYQxSEfbqfhLx38Mos",
				authDomain: "helloworld-5b272.firebaseapp.com",
				databaseURL: "https://helloworld-5b272.firebaseio.com",
				projectId: "helloworld-5b272",
				storageBucket: "helloworld-5b272.appspot.com",
				messagingSenderId: "777363750227"
			};
			firebase.initializeApp(config);


			firebase.auth().signInAnonymously().then(({ uid }) => {
				// room.getUsers().then(users => {
				// 	users = users;
				// });

				var firebaseChat = new FirebaseChat(firebase.database());

				var room = firebaseChat.createRoom(1042);
				window.room = room;

				room.registerUser(uid, "Marcelo").then(user => {
					window.user = user;
				});

				var users = [];
				window.users = users;


				room.on('user_enter', (user) => {
					console.log("user_enter", user);
					user.on('status_change', console.log);
					user.on('online_change', console.log);
					users.push(user);
				});

			}).catch(function(error) {
				var errorCode = error.code;
				var errorMessage = error.message;
				if (errorCode === 'auth/operation-not-allowed') {
					alert('You must enable Anonymous auth in the Firebase Console.');
				} else {
					console.error(error);
				}
			});


		</script>
	</head>
	<body>
	</body>
</html>